<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Meghadutam: The Cloud's Journey</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://unpkg.com/maplibre-gl@3.5.2/dist/maplibre-gl.css" rel="stylesheet" />

<style>
html, body {
    margin: 0;
    height: 100%;
    background: #1b1a17;
    font-family: Georgia, serif;
}

#map {
    width: 100%;
    height: 100vh;
}

/* Title */
#title {
    position: absolute;
    top: 18px;
    width: 100%;
    text-align: center;
    color: #e7d9b6;
    font-size: 26px;
    z-index: 10;
    pointer-events: none;
}

/* Custom Pin */
.custom-pin {
    width: 18px;
    height: 18px;
    background: #bfa57a;
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    position: relative;
    box-shadow: 0 0 6px rgba(0,0,0,0.6);
    cursor: pointer;
}
.custom-pin::after {
    content: "";
    width: 8px;
    height: 8px;
    background: #3b2f24;
    position: absolute;
    top: 5px;
    left: 5px;
    border-radius: 50%;
}

/* Popup styling */
.maplibregl-popup-content {
    background: #2b2721;
    color: #eadfc4;
    border: 1px solid #a89164;
    width: 260px;
    padding: 0;
    font-family: Georgia, serif;
}

.popup-header {
    padding: 10px;
    font-size: 18px;
    font-weight: bold;
    border-bottom: 1px solid #8f7b52;
}

.popup-body {
    padding: 10px;
}

.popup-body img {
    width: 100%;
    border-radius: 4px;
    margin-bottom: 8px;
}

.popup-actions {
    display: flex;
    justify-content: space-between;
    padding: 10px;
}

.popup-actions button {
    background: #bfa57a;
    border: none;
    padding: 6px 10px;
    font-size: 13px;
    cursor: pointer;
}

.popup-actions button:hover {
    background: #d7c08b;
}

/* Intro modal */
#intro {
    position: absolute;
    inset: 0;
    background: rgba(20,18,15,0.93);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 20;
}

#intro-box {
    background: #2b2621;
    padding: 32px;
    max-width: 420px;
    text-align: center;
    border: 1px solid #a28d64;
}

#intro button {
    margin-top: 14px;
    padding: 10px 16px;
    background: #bfa57a;
    border: none;
    cursor: pointer;
}
</style>
</head>

<body>

<div id="title">Meghadutam: The Cloud's Journey</div>
<div id="map"></div>

<div id="intro">
    <div id="intro-box">
        <h2>Svāgatam</h2>
        <p>
            Follow the cloud across sacred landscapes — where poetry,
            memory, and geography converge.
        </p>
        <button onclick="startJourney()">Begin the Journey</button>
        <button onclick="window.open('https://example.com','_blank')">Read the Introduction</button>
    </div>
</div>

<script src="https://unpkg.com/maplibre-gl@3.5.2/dist/maplibre-gl.js"></script>

<script>
const locations = [
    {
        name: "Ramtek",
        coords: [79.327, 21.397],
        image: "https://upload.wikimedia.org/wikipedia/commons/5/5b/Ramtek_Temple.jpg",
        text: "The cloud begins its journey from the sacred hills of Ramtek.",
        link: "https://en.wikipedia.org/wiki/Ramtek"
    },
    {
        name: "Amarkantak",
        coords: [81.753, 22.676],
        image: "https://upload.wikimedia.org/wikipedia/commons/1/1e/Amarkantak.jpg",
        text: "Birthplace of rivers and forests of memory.",
        link: "https://en.wikipedia.org/wiki/Amarkantak"
    },
    {
        name: "Vidisha",
        coords: [77.807, 23.526],
        image: "https://upload.wikimedia.org/wikipedia/commons/3/3e/Vidisha_India.jpg",
        text: "A meeting point of empire and devotion.",
        link: "https://en.wikipedia.org/wiki/Vidisha"
    },
    {
        name: "Udayagiri",
        coords: [77.736, 23.536],
        image: "https://upload.wikimedia.org/wikipedia/commons/6/6a/Udayagiri_caves.jpg",
        text: "Where stone learned to breathe divinity.",
        link: "https://en.wikipedia.org/wiki/Udayagiri_Caves"
    },
    {
        name: "Ujjain",
        coords: [75.784, 23.179],
        image: "https://upload.wikimedia.org/wikipedia/commons/9/98/Mahakaleshwar_Temple_Ujjain.jpg",
        text: "The heart of cosmic time itself.",
        link: "https://en.wikipedia.org/wiki/Ujjain"
    }
];

let map, currentIndex = 0;

map = new maplibregl.Map({
    container: 'map',
    style: 'https://api.maptiler.com/maps/satellite/style.json?key=2KLPs3v6SocVNHhNtM9X',
    center: [78, 22],
    zoom: 5
});

function createPopupContent(loc, index) {
    return `
        <div class="popup-header">${loc.name}</div>
        <div class="popup-body">
            <img src="${loc.image}">
            <p>${loc.text}</p>
        </div>
        <div class="popup-actions">
            <button onclick="window.open('${loc.link}','_blank')">Read more</button>
            <button onclick="goNext(${index})">Next</button>
        </div>
    `;
}

function createMarker(loc, index) {
    const el = document.createElement("div");
    el.className = "custom-pin";

    const popup = new maplibregl.Popup({ offset: 25 })
        .setHTML(createPopupContent(loc, index));

    el.addEventListener("click", () => {
        popup.setLngLat(loc.coords).addTo(map);
    });

    new maplibregl.Marker(el).setLngLat(loc.coords).addTo(map);
}

function goNext(index) {
    const next = (index + 1) % locations.length;
    flyTo(next);
}

function flyTo(index) {
    currentIndex = index;
    const loc = locations[index];
    map.flyTo({
        center: loc.coords,
        zoom: 8,
        speed: 0.8,
        curve: 1.4
    });

    new maplibregl.Popup()
        .setLngLat(loc.coords)
        .setHTML(createPopupContent(loc, index))
        .addTo(map);
}

locations.forEach((loc, i) => createMarker(loc, i));

function startJourney() {
    document.getElementById("intro").style.display = "none";
    flyTo(0);
}
</script>

</body>
</html>

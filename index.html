<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Meghadutam – The Cloud’s Journey</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

<style>
body {
    margin: 0;
    background: #f5f1e8;
    font-family: "Georgia", "Times New Roman", serif;
    color: #3b2f24;
}

h1 {
    text-align: center;
    padding: 20px 0 10px;
    font-weight: normal;
    letter-spacing: 1.5px;
    color: #7a5c42;
}

#container {
    display: flex;
    height: 80vh;
    margin: 0 5%;
    gap: 20px;
}

#map {
    flex: 2;
    border-radius: 16px;
    border: 1px solid #d0c2b0;
    min-height: 80vh;
}

#info {
    flex: 1;
    background: #ede5db;
    border: 1px solid #d0c2b0;
    border-radius: 16px;
    padding: 22px;
    box-shadow: inset 0 0 12px rgba(0,0,0,0.1);
    font-size: 16px;
    line-height: 1.65;
}

#info h2 {
    margin-top: 0;
    color: #7a5c42;
    font-weight: normal;
}

.link {
    display: inline-block;
    margin-top: 12px;
    color: #a07c56;
    text-decoration: none;
    border-bottom: 1px solid #a07c56;
}

.link:hover {
    color: #c09e70;
    border-color: #c09e70;
}

/* Custom pin */
.custom-pin {
    width: 18px;
    height: 18px;
    background: #bfa57a;
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    position: relative;
    box-shadow: 0 0 6px rgba(0,0,0,0.3);
}

.custom-pin::after {
    content: "";
    width: 8px;
    height: 8px;
    background: #3b2f24;
    position: absolute;
    top: 5px;
    left: 5px;
    border-radius: 50%;
}
</style>
</head>

<body>

<h1>Meghadutam — The Cloud’s Journey</h1>

<div id="container">
    <div id="map"></div>
    <div id="info">
        <h2>Welcome</h2>
        <p>
            Follow the journey of the cloud across sacred landscapes,
            where poetry and geography converge.
        </p>
    </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
// Initialize map
const map = L.map('map', { zoomControl: false }).setView([23.0, 78.0], 6);

// Light-themed map
L.tileLayer('https://{s}.basemaps.cartocdn.com/voyager/{z}/{x}/{y}{r}.png', {
    attribution: '&copy; OpenStreetMap contributors &copy; CARTO',
    subdomains: 'abcd',
    maxZoom: 19
}).addTo(map);

// Locations
const locations = [
    { name: "Ramtek", coords: [21.3972, 79.3271], text: "A hill of exile, memory, and epic resonance.", link: "/blog/ramtek" },
    { name: "Amarkantak", coords: [22.6749, 81.7596], text: "Source of the Narmada, where rivers are born of stone.", link: "/blog/amarkantak" },
    { name: "Vidisha", coords: [23.5251, 77.8081], text: "Gateway to the Gupta sacred landscape and early temple art.", link: "/blog/vidisha" },
    { name: "Udayagiri", coords: [23.5244, 77.7296], text: "Caves carved with cosmic symbolism and royal devotion.", link: "/blog/udayagiri" },
    { name: "Ujjain", coords: [23.1765, 75.7885], text: "The city of Mahākāla, where time itself is worshipped.", link: "/blog/ujjain" }
];

// Custom pins
const pinIcon = L.divIcon({
    className: '',
    html: '<div class="custom-pin"></div>',
    iconSize: [18, 18],
    iconAnchor: [9, 18]
});

// Add markers and click info
locations.forEach(place => {
    const marker = L.marker(place.coords, { icon: pinIcon }).addTo(map);
    marker.on("click", () => {
        document.getElementById("info").innerHTML = `
            <h2>${place.name}</h2>
            <p>${place.text}</p>
            <a class="link" href="${place.link}">Read more →</a>
        `;
    });
});

// Cloud animation
const journeyCoords = locations.map(l => l.coords);

// Draw soft dashed polyline path
const cloudPath = L.polyline(journeyCoords, {
    color: '#f0e6d2',
    weight: 3,
    opacity: 0.5,
    dashArray: '8, 10'
}).addTo(map);

// Create cloud icon
const cloudIcon = L.divIcon({
    className: '',
    html: '<div style="width:24px;height:24px;background:#ffffff;border-radius:50%;opacity:0.8;box-shadow:0 0 12px rgba(255,255,255,0.5);"></div>',
    iconSize: [24, 24],
    iconAnchor: [12, 12]
});

// Add cloud marker
const cloudMarker = L.marker(journeyCoords[0], {icon: cloudIcon}).addTo(map);

// Animate cloud along polyline with easing
let progress = 0;
const speed = 0.0015; // slower = smoother movement

function animateCloud() {
    progress += speed;
    if(progress > 1) progress = 0; // loop

    const latlng = getLatLngAtProgress(cloudPath, progress);
    cloudMarker.setLatLng(latlng);

    requestAnimationFrame(animateCloud);
}

// Helper to interpolate LatLng along the path
function getLatLngAtProgress(polyline, t) {
    const latlngs = polyline.getLatLngs();
    const total = latlngs.length - 1;
    const index = Math.floor(t * total);
    const ratio = (t * total) - index;

    const from = latlngs[index];
    const to = latlngs[Math.min(index + 1, total)];

    const lat = from.lat + (to.lat - from.lat) * ratio;
    const lng = from.lng + (to.lng - from.lng) * ratio;

    return [lat, lng];
}

animateCloud();
</script>

</body>
</html>
